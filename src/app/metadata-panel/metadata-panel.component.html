<div class="mt-3">
  <p-card>
    <div class="flex flex-column">
      <div class="flex justify-content-center">
        <h2>{{"PAGE.CONCORDANCE.METADATA" | translate}}</h2>
      </div>
      <div *ngIf="loading > 0" class="text-center">
        <p-progressSpinner [style]="{width: '50px', height: '50px'}"></p-progressSpinner>
      </div>
      <div class="mt-4">
        <h2>{{"PAGE.CONCORDANCE.TEXT_TYPE" | translate}}</h2>
      </div>
      <p-scrollPanel [style]="{width: '100%'}" styleClass="custombar">
        <ng-container *ngIf="!isImpaqtsCustom">
          <div *ngFor="let metadatum of metadata, let i = index" class="field mb-2 flex justify-content-start w-12 grid">
            <!-- FreeText-->
            <label *ngIf="!metadatum.multipleChoice && metadatum.freeText" class="col-3">{{(metadatum.label ? metadatum.label : metadatum.name) |
              translate}}</label>
            <div *ngIf="!metadatum.multipleChoice && metadatum.freeText" class="col-9">
              <input type="text" pInputText [(ngModel)]="metadatum.selection" class="w-12">
            </div>
            <!-- Tree & checkbox-->
            <div class="col-6" *ngIf="metadatum.tree && (metadatum.tree.length > 0) && metadatum.multipleChoice" class="col-12">
              <p-tree [value]="metadatum.tree" selectionMode="checkbox" [(selection)]="metadatum.selection">
              </p-tree>
            </div>
            <!-- Single selection -->
            <div class="col-6" *ngIf="metadatum.tree && (metadatum.tree.length > 0) && !metadatum.multipleChoice" class="col-12">
              <p-tree [value]="metadatum.tree" selectionMode="single" [(selection)]="metadatum.selection"
                (onNodeSelect)="nodeSelect($event)" class="text-red">
              </p-tree>
            </div>
          </div>
        </ng-container>
        <div *ngIf="isImpaqtsCustom">
          <p-card *ngFor="let mg of metadataGroupedList">
            <div class="flex justify-content-center">
              <h2>{{'METADATA_OPT.'+ mg.metadatumGroup.name | translate}}</h2>
            </div>
            <div *ngFor="let metadatum of mg.metadata, let i = index" class="field mb-2 flex justify-content-start w-12 grid">
              <!-- FreeText-->
              <label *ngIf="!metadatum.multipleChoice && metadatum.freeText" class="col-3">{{(metadatum.label ? metadatum.label : metadatum.name) |
                translate}}</label>
              <div *ngIf="!metadatum.multipleChoice && metadatum.freeText" class="col-9">
                <input type="text" pInputText [(ngModel)]="metadatum.selection" class="w-12">
              </div>
              <!-- Tree & checkbox-->
              <div *ngIf="metadatum.tree && (metadatum.tree.length > 0) && metadatum.multipleChoice" class="col-12">
                <p-tree [value]="metadatum.tree" selectionMode="checkbox" [(selection)]="metadatum.selection">
                </p-tree>
              </div>
              <!-- Single selection -->
              <div *ngIf="metadatum.tree && (metadatum.tree.length > 0) && !metadatum.multipleChoice" class="col-12">
                <p-tree [value]="metadatum.tree" selectionMode="single" [(selection)]="metadatum.selection"
                  (onNodeSelect)="nodeSelect($event)" class="text-red">
                </p-tree>
              </div>
            </div>
          </p-card>
        </div>
      </p-scrollPanel>
      <span class="flex justify-content-center">
        <button pButton type=" button" label="{{'PAGE.CLEAR' | translate}}" [disabled]="loading"
          (click)="resetMetadata()"></button>
      </span>
    </div>
  </p-card>
</div>